{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@foskym/flarum-oauth-center/webpack/bootstrap","webpack://@foskym/flarum-oauth-center/webpack/runtime/compat get default export","webpack://@foskym/flarum-oauth-center/webpack/runtime/define property getters","webpack://@foskym/flarum-oauth-center/webpack/runtime/hasOwnProperty shorthand","webpack://@foskym/flarum-oauth-center/webpack/runtime/make namespace object","webpack://@foskym/flarum-oauth-center/external root \"flarum.core.compat['common/extenders']\"","webpack://@foskym/flarum-oauth-center/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@foskym/flarum-oauth-center/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@foskym/flarum-oauth-center/external root \"flarum.core.compat['common/Model']\"","webpack://@foskym/flarum-oauth-center/./src/common/models/Client.js","webpack://@foskym/flarum-oauth-center/./src/common/models/Scope.js","webpack://@foskym/flarum-oauth-center/./src/common/extend.js","webpack://@foskym/flarum-oauth-center/external root \"flarum.core.compat['forum/app']\"","webpack://@foskym/flarum-oauth-center/external root \"flarum.core.compat['common/extend']\"","webpack://@foskym/flarum-oauth-center/external root \"flarum.core.compat['forum/components/UserPage']\"","webpack://@foskym/flarum-oauth-center/external root \"flarum.core.compat['common/components/LinkButton']\"","webpack://@foskym/flarum-oauth-center/external root \"flarum.core.compat['common/components/Page']\"","webpack://@foskym/flarum-oauth-center/external root \"flarum.core.compat['forum/components/IndexPage']\"","webpack://@foskym/flarum-oauth-center/external root \"flarum.core.compat['forum/components/LogInModal']\"","webpack://@foskym/flarum-oauth-center/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@foskym/flarum-oauth-center/external root \"flarum.core.compat['common/components/Tooltip']\"","webpack://@foskym/flarum-oauth-center/external root \"flarum.core.compat['common/components/Button']\"","webpack://@foskym/flarum-oauth-center/./src/forum/components/oauth/AuthorizePage.js","webpack://@foskym/flarum-oauth-center/./src/forum/components/user/AuthorizedPage.js","webpack://@foskym/flarum-oauth-center/./src/forum/index.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extenders'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","import Model from 'flarum/common/Model';\n\nexport default class Client extends Model {\n  client_id = Model.attribute('client_id');\n  client_secret = Model.attribute('client_secret');\n  redirect_uri = Model.attribute('redirect_uri');\n  grant_types = Model.attribute('grant_types');\n  scope = Model.attribute('scope');\n  user_id = Model.attribute('user_id');\n  client_name = Model.attribute('client_name');\n  client_icon = Model.attribute('client_icon');\n  client_desc = Model.attribute('client_desc');\n  client_home = Model.attribute('client_home');\n}\n","import Model from 'flarum/common/Model';\n\nexport default class Scope extends Model {\n  scope = Model.attribute('scope');\n  resource_path = Model.attribute('resource_path');\n  method = Model.attribute('method');\n  is_default = Model.attribute('is_default');\n  scope_name = Model.attribute('scope_name');\n  scope_icon = Model.attribute('scope_icon');\n  scope_desc = Model.attribute('scope_desc');\n}\n","import Extend from 'flarum/common/extenders';\nimport Client from \"./models/Client\";\nimport Scope from \"./models/Scope\";\n\nexport default [\n  new Extend.Store()\n    .add('oauth-clients', Client)\n    .add('oauth-scopes', Scope),\n];\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/UserPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LinkButton'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Page'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/IndexPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/LogInModal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/extractText'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Tooltip'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","import app from 'flarum/forum/app';\nimport {extend} from 'flarum/common/extend';\nimport Page from 'flarum/common/components/Page';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport LogInModal from 'flarum/forum/components/LogInModal';\nimport extractText from 'flarum/common/utils/extractText';\nimport Tooltip from 'flarum/common/components/Tooltip';\nimport Button from 'flarum/common/components/Button';\n\nexport default class AuthorizePage extends IndexPage {\n  params = [];\n  client = null;\n  scopes = null;\n  client_scope = [];\n  loading = true;\n  is_authorized = false;\n\n  oninit(vnode) {\n    super.oninit(vnode);\n    if (!app.session.user) {\n      setTimeout(() => app.modal.show(LogInModal), 500);\n    }\n\n    const params = m.route.param();\n\n    if (params.client_id == null || params.response_type == null || params.redirect_uri == null) {\n      m.route.set('/');\n    } else {\n      this.params = params;\n      app.store.find('oauth-clients', params.client_id).then(client => {\n        if (client.length === 0) {\n          m.route.set('/');\n        } else {\n          this.client = client[0];\n          let uris = null;\n          if (this.client.redirect_uri().indexOf(' ') > -1) {\n            uris = this.client.redirect_uri().split(' ');\n          } else {\n            uris = [this.client.redirect_uri()];\n          }\n\n          if (app.forum.attribute('foskym-oauth-center.require_exact_redirect_uri') && uris.indexOf(params.redirect_uri) == -1) {\n            m.route.set('/');\n          }\n          if (app.forum.attribute('foskym-oauth-center.allow_implicit') && params.response_type == 'token') {\n            m.route.set('/');\n          }\n          if (app.forum.attribute('foskym-oauth-center.enforce_state') && params.enforce_state == null) {\n            m.route.set('/');\n          }\n\n          app.store.find('oauth-scopes').then((scopes) => {\n            this.scopes = scopes\n            let scope = params.scope;\n\n            if (params.scope == null) {\n              scope = this.client.scope();\n            }\n\n            let scopes_temp = [];\n            if (scope == null) {\n              scopes_temp = [];\n            } else if (scope.indexOf(' ') > -1) {\n              scopes_temp = scope.split(' ');\n            } else {\n              scopes_temp = [scope];\n            }\n\n            let default_scopes = [];\n            this.scopes.map(scope => {\n              if (scope.is_default() === 1) {\n                default_scopes.push(scope);\n              }\n            });\n\n            scopes_temp = scopes_temp.concat(default_scopes);\n\n            this.client_scope = scopes_temp.filter((scope, index) => scopes_temp.indexOf(scope) === index);\n            console.log( this.client_scope );\n            this.loading = false;\n            m.redraw();\n          });\n\n\n        }\n      });\n    }\n  }\n\n  setTitle() {\n    app.setTitle(extractText(app.translator.trans('foskym-oauth-center.forum.page.title.authorize')));\n    app.setTitleCount(0);\n  }\n\n  view() {\n    if (!this.client) {\n      return '';\n    }\n    return (\n      !this.loading && <div className=\"AuthorizePage\">\n        <div className=\"container\">\n          <div class=\"oauth-area\">\n            <div class=\"oauth-main\">\n              <div class=\"oauth-box oauth-header\">\n                <h2>{app.forum.attribute('title')}</h2>\n                <p>\n                  {app.translator.trans('foskym-oauth-center.forum.authorize.access')} <a\n                  href={this.client.client_home()} target=\"_blank\">{this.client.client_name()}</a>\n                </p>\n\n              </div>\n              <div class=\"oauth-box oauth-body\">\n\n                <div class=\"oauth-top\">\n                  <img src={app.forum.attribute('faviconUrl')}/>\n                  <i class=\"fas fa-exchange-alt fa-2x\"></i>\n                  <Tooltip text={this.client.client_desc()}>\n                    <img src={this.client.client_icon()}/>\n                  </Tooltip>\n                </div>\n                <div class=\"oauth-scope-area\">\n                  {\n                    this.client_scope.length > 0 && this.client_scope.map(scope => {\n                      let scope_info = null;\n                      this.scopes.map(s => {\n                        if (s.scope() === scope.scope()) {\n                          scope_info = s;\n                        }\n                      });\n                      if (scope_info == null) {\n                        return '';\n                      }\n                      return (\n                        <div class=\"oauth-scope\">\n                          <div class=\"oauth-scope-left\">\n                            {\n                              (scope_info.scope_icon().indexOf('fa-') > -1) ?\n                              <i class={\"oauth-scope-object fa-2x \" + scope_info.scope_icon()}\n                                 style=\"margin-left:2px;color:#000\"></i> :\n                              <img class=\"oauth-scope-object\" src={scope_info.scope_icon()} style=\"width:32px\"/>\n                            }\n                          </div>\n                          <div class=\"oauth-scope-body\">\n                            <h6 class=\"oauth-scope-heading\">\n                              {scope_info.scope_name()}\n                            </h6>\n                            <small>\n                              {\n                                scope_info.scope_desc()\n                                  .replace('{client_name}', this.client.client_name())\n                                  .replace('{user}', app.session.user.attribute('displayName'))\n                              }\n                            </small>\n                          </div>\n                        </div>\n                      );\n                    })\n                  }\n                </div>\n                <form class=\"oauth-form\" method=\"post\" id=\"form\" onsubmit={this.onsubmit.bind(this)}>\n{/*                  <input type=\"hidden\" name=\"response_type\" value={this.params.response_type}/>\n                  <input type=\"hidden\" name=\"client_id\" value={this.params.client_id}/>\n                  <input type=\"hidden\" name=\"redirect_uri\"\n                         value={this.params.redirect_uri}/>\n                  <input type=\"hidden\" name=\"state\" value={this.params.state}/>\n                  <input type=\"hidden\" name=\"scope\" value={this.params.scope}/>*/}\n                  <input type=\"hidden\" name=\"is_authorized\" value={this.is_authorized}/>\n                  <div style=\"display: flex; margin-top: 15px\" class=\"oauth-form-item\">\n                    <Button className=\"Button\" type=\"submit\" style=\"width: 50%;\" onclick={\n                      this.is_authorized = false\n                    }>\n                      {app.translator.trans('foskym-oauth-center.forum.authorize.deny')}\n                    </Button>\n                    <Button className=\"Button Button--primary\" type=\"submit\" style=\"width: 50%;\" onclick={\n                      this.is_authorized = true\n                    }>\n                      {app.translator.trans('foskym-oauth-center.forum.authorize.agree')}\n                    </Button>\n                  </div>\n                </form>\n\n\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  onsubmit(e) {\n    e.preventDefault();\n    app.request({\n      method: 'POST',\n      url: '/oauth/authorize',\n      body: {\n        response_type: this.params.response_type,\n        client_id: this.params.client_id,\n        redirect_uri: this.params.redirect_uri,\n        state: this.params.state,\n        scope: this.params.scope,\n        is_authorized: this.is_authorized,\n      }\n    }).then((r) => console.log(r));\n\n    // Some form handling logic here\n  }\n}\n","import UserPage from 'flarum/forum/components/UserPage';\nexport default class AuthorizedPage extends UserPage {\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.loadUser(m.route.param('username'));\n  }\n  content() {\n    return (\n      <div className=\"AuthorizedPage\">\n      </div>\n    );\n  }\n}\n","import app from 'flarum/forum/app';\nimport {extend} from 'flarum/common/extend';\nimport UserPage from 'flarum/forum/components/UserPage';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport AuthorizePage from \"./components/oauth/AuthorizePage\";\nimport AuthorizedPage from \"./components/user/AuthorizedPage\";\napp.initializers.add('foskym/flarum-oauth-center', () => {\n  app.routes['oauth.authorize'] = {\n    path: '/oauth/authorize',\n    component: AuthorizePage\n  };\n\n  app.routes['user.authorized'] = {\n    path: '/u/:username/authorized',\n    component: AuthorizedPage\n  };\n  extend(UserPage.prototype, 'navItems', function (items) {\n    if (app.session.user && app.session.user.id() === this.user.id()) {\n      items.add(\n        'authorized',\n        LinkButton.component(\n          {\n            href: app.route('user.authorized', { username: this.user.username() }),\n            icon: 'fas fa-user-friends',\n          },\n          [\n            app.translator.trans('foskym-oauth-center.forum.page.label.authorized'),\n            // this.user.moderatorNoteCount() > 0 ? <span className=\"Button-badge\">{this.user.moderatorNoteCount()}</span> : '',\n          ]\n        ),\n        -110\n      );\n    }\n  });\n});\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","_inheritsLoose","subClass","superClass","create","constructor","Client","_Model","_this","_len","arguments","length","args","Array","_key","apply","concat","client_id","Model","client_secret","redirect_uri","grant_types","scope","user_id","client_name","client_icon","client_desc","client_home","Scope","resource_path","method","is_default","scope_name","scope_icon","scope_desc","Extend","add","AuthorizePage","_IndexPage","params","client","scopes","client_scope","loading","is_authorized","_proto","oninit","vnode","_this2","app","user","setTimeout","show","LogInModal","m","route","param","response_type","set","this","find","then","uris","indexOf","split","attribute","enforce_state","scopes_temp","default_scopes","map","push","filter","index","console","log","redraw","setTitle","extractText","trans","view","_this3","className","class","href","target","src","Tooltip","text","scope_info","s","style","replace","id","onsubmit","type","name","Button","onclick","e","preventDefault","url","body","state","r","IndexPage","AuthorizedPage","_UserPage","loadUser","content","UserPage","path","component","extend","items","LinkButton","username","icon"],"sourceRoot":""}